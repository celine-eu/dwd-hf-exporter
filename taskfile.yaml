version: "3"

tasks:
  apply:
    deps: [delete]
    cmds:
      - kubectl create secret generic dwd-hf-exporter-env --from-file=env=.env
      - kubectl apply -f job.yaml
      - sleep 2
      - kubectl logs job/dwd-hf-exporter -f

  delete:
    cmds:
      - kubectl delete secret dwd-hf-exporter-env || true
      - kubectl delete -f job.yaml || true

  bash:
    cmds:
      - kubectl exec -it dwd-hf-exporter -- bash

  logs:
    cmds:
      - kubectl logs dwd-hf-exporter -f
